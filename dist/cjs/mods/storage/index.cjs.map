{"version":3,"file":"index.cjs","sources":["../../../../src/mods/storage/index.ts"],"sourcesContent":["/**\n * Use WebAuthn to store authentication-protected arbitrary bytes\n * \n * @param name user-friendly name for the data\n * @param data arbitrary data of 64 bytes or less\n * @returns handle to the data\n */\nexport async function createOrThrow(name: string, data: Uint8Array): Promise<Uint8Array> {\n  const credential = await navigator.credentials.create({\n    publicKey: {\n      challenge: new Uint8Array([117, 61, 252, 231, 191, 241]),\n      rp: {\n        id: location.hostname,\n        name: location.hostname\n      },\n      user: {\n        id: data,\n        name: name,\n        displayName: name\n      },\n      pubKeyCredParams: [\n        { type: \"public-key\", alg: -7 },\n        { type: \"public-key\", alg: -8 },\n        { type: \"public-key\", alg: -257 }\n      ],\n      authenticatorSelection: {\n        authenticatorAttachment: \"platform\"\n      }\n    }\n  }) as any\n\n  return new Uint8Array(credential.rawId)\n}\n\n/**\n * Use WebAuthn to retrieve authentication-protected arbitrary bytes\n * \n * @param id handle to the data\n * @returns data\n */\nexport async function getOrThrow(id: Uint8Array): Promise<Uint8Array> {\n  const credential = await navigator.credentials.get({\n    publicKey: {\n      challenge: new Uint8Array([117, 61, 252, 231, 191, 241]),\n      allowCredentials: [{ type: \"public-key\", id }],\n    }\n  }) as any\n\n  return new Uint8Array(credential.response.userHandle)\n}"],"names":[],"mappings":";;AAAA;;;;;;AAMG;AACI,eAAe,aAAa,CAAC,IAAY,EAAE,IAAgB,EAAA;IAChE,MAAM,UAAU,GAAG,MAAM,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC;AACpD,QAAA,SAAS,EAAE;AACT,YAAA,SAAS,EAAE,IAAI,UAAU,CAAC,CAAC,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;AACxD,YAAA,EAAE,EAAE;gBACF,EAAE,EAAE,QAAQ,CAAC,QAAQ;gBACrB,IAAI,EAAE,QAAQ,CAAC,QAAQ;AACxB,aAAA;AACD,YAAA,IAAI,EAAE;AACJ,gBAAA,EAAE,EAAE,IAAI;AACR,gBAAA,IAAI,EAAE,IAAI;AACV,gBAAA,WAAW,EAAE,IAAI;AAClB,aAAA;AACD,YAAA,gBAAgB,EAAE;gBAChB,EAAE,IAAI,EAAE,YAAY,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE;gBAC/B,EAAE,IAAI,EAAE,YAAY,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE;gBAC/B,EAAE,IAAI,EAAE,YAAY,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE;AAClC,aAAA;AACD,YAAA,sBAAsB,EAAE;AACtB,gBAAA,uBAAuB,EAAE,UAAU;AACpC,aAAA;AACF,SAAA;AACF,KAAA,CAAQ,CAAA;AAET,IAAA,OAAO,IAAI,UAAU,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;AACzC,CAAC;AAED;;;;;AAKG;AACI,eAAe,UAAU,CAAC,EAAc,EAAA;IAC7C,MAAM,UAAU,GAAG,MAAM,SAAS,CAAC,WAAW,CAAC,GAAG,CAAC;AACjD,QAAA,SAAS,EAAE;AACT,YAAA,SAAS,EAAE,IAAI,UAAU,CAAC,CAAC,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;YACxD,gBAAgB,EAAE,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,EAAE,EAAE,CAAC;AAC/C,SAAA;AACF,KAAA,CAAQ,CAAA;IAET,OAAO,IAAI,UAAU,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAA;AACvD;;;;;"}